server:
  port: 8116
  # Handle reverse proxy headers
  # https://springdoc.org/#how-can-i-deploy-springdoc-openapi-ui-behind-a-reverse-proxy
  forward-headers-strategy: framework

velco:
  security:
    authentication-headers:
      - "authorization"
      - "x-api-key"
    auth-secret-key: $VELCO_SECURITY_AUTH_SECRET_KEY # Same value as authentication module
    api-secret-key: $VELCO_SECURITY_API_SECRET_KEY # For x-api-key
    unauthenticated-endpoints:
      get:
        - "/actuator/*"
        - "/swagger-ui/**"
        - "/v3/api-docs"
        - "/v3/api-docs/*"
      post: # Nothing for now
  swagger:
    server-url: https://logbook-api.test.velco.bike

spring:
  application:
    name: logbook-api # Must be coherent with the gateway module configuration (id)
  cloud:
    inetutils:
      ignored-interfaces:
        - eth0
        - eth1
        - lo
        - tun0
  datasource:
    url: jdbc:mariadb://localhost:3306/velco?serverTimezone=CET&tinyInt1isBit=false
    username: logbook-api
    password: $SPRING_DATASOURCE_PASSWORD
  jpa:
    properties:
      hibernate:
        hbm2ddl.auto: validate # Check the coherence between the schema and the mapping
  rabbitmq:
    listener:
      simple:
        batch-size: 250
        prefetch: 250
        retry:
          multiplier: 2.0
          initial-interval: 10000
          max-attempts: 4
          max-interval: 80000
          enabled: true

eureka:
  client:
    serviceUrl:
      defaultZone: http://localhost:8069/eureka

feign:
  client:
    config:
      default:
        connectTimeout: 20000
        readTimeout: 60000 # 60 seconds

springdoc:
  swagger-ui:
    url: /api/logbook-api/v3/api-docs # Force swagger to load this url (And not petstore)
    configUrl: /api/logbook-api/v3/api-docs/swagger-config # Force swagger to load this url (And not /v3/api-docs/swagger-config)

management:
  endpoints:
    enabled-by-default: false
    web:
      exposure:
        include: info, health, loggers
  endpoint:
    info:
      enabled: true
      git:
        enabled: true
        mode: full
    health:
      enabled: true
    loggers:
      enabled: true

logback:
  production: true

amqp-configurations:
  exchanges:
    logbook:
      hostname: 192.168.0.216
      port: 5672
      virtual-host: applications
      username: logbook
      password: $AMQP_CONFIGURATIONS_EXCHANGES_LOGBOOK_PASSWORD
      exchange-name: logbook
      routing-keys:
        logbook-event: logbook-event
