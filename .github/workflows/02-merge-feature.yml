name: ü§ù Merge feature
on:
  push:
jobs:
  #  integrate-kotlin:
  #    name: ‚ñ∂Ô∏è Integrate kotlin
  #    uses: VelcoTech/github-workflows/.github/workflows/integrate-kotlin.yml@feature/daws-27 # TODO UPDATE GIT REF
  get-metadata-kotlin:
    name: üß¨ Get metadata kotlin
    uses: VelcoTech/github-workflows/.github/workflows/get-metadata-kotlin.yml@feature/daws-27 # TODO UPDATE GIT REF
  build-kotlin:
    name: üì¶ Build kotlin
    uses: VelcoTech/github-workflows/.github/workflows/build-kotlin.yml@feature/daws-27 # TODO UPDATE GIT REF
    with:
      java-version: '17'
  debug:
    name: debug
    runs-on: ubuntu-22.04
    steps:
      - name: debug
        run: echo ${{ needs.get-metadata-kotlin.outputs.build-final-name }}
  deploy-kotlin:
    name: üöÄ Deploy kotlin
    uses: VelcoTech/github-workflows/.github/workflows/deploy-kotlin.yml@feature/daws-27 # TODO UPDATE GIT REF
    needs: [get-metadata-kotlin, build-kotlin]
    with:
      env: 'test'
      type: 'artifact'
      build-final-name: ${{ needs.get-metadata-kotlin.outputs.build-final-name }}
    secrets:
      WIREGUARD_CONFIGURATION: ${{ secrets.WIREGUARD_CONFIGURATION }}
      HOST: ${{ secrets.ON_PREMISE_TEST_HOST }}
      PORT: ${{ secrets.ON_PREMISE_TEST_PORT }}
      PEM: ${{ secrets.ON_PREMISE_TEST_PEM }}
      PASSPHRASE: ${{ secrets.ON_PREMISE_TEST_PASSPHRASE }}
      ASSETS_ACCESS_TOKEN: ${{ secrets.ASSETS_ACCESS_TOKEN }}
